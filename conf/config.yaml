

hydra:
  job:
    chdir: false

iterations:

  nb_iterations: 248
  iteration_runner_args:
    nb_parallel_games: 64
    games_per_iteration: 248

  dond_game_args:
    rounds_per_game: 1
    max_turns: 10
    player_order: deterministic # deterministic or random player who start beginning of each round
    mode: coop # basic, coop
    setup: manual # manual or random_read
    player_0_values: [20, 10]
    player_1_values: [10, 20]
    items: ['gold', 'silver']
    quantities: [10, 5]
    setups_file: src/environments/dond_setups.txt
    finalization_visibility: True


models: 
  llama:
    class: hf
    init_args:
      name: 'llama'
      device: "cuda"
      pretrained_args: 
        pretrained_model_name_or_path: "meta-llama/Meta-Llama-3.1-8B-Instruct"
        torch_dtype: "bfloat16"
        device_map: "auto"
      bits_and_bytes_args:
        load_in_8bit: False
      lora_args:
        task_type: TaskType.CAUSAL_LM
        r: 128
        lora_alpha: 128
        lora_dropout: 0
        target_modules: "all-linear"
      ppo_trainer_args: # see https://github.com/huggingface/trl/blob/main/trl/trainer/ppo_config.py
        batch_size: 248
        mini_batch_size: 1
        gradient_accumulation_steps: None
        ppo_epochs: 1
        vf_coef: 0
        gradient_checkpointing: False
        log_with: "tensorboard"
        project_kwargs: None
        tracker_project_name: "tensorboard"
        target_kl: 0.1
        cliprange: 0.2
        init_kl_coef: 0.2
        learning_rate: 10e-4
      save_lora_weights: True
      lora_pretrained_path: null
      generation_args:
        max_tokens: 500
        temperature: 0.7
        top_k: 10
        top_p: 0.1


players: 
  player_a:
    id: 0 # Will be used by game to determine which player starts
    dond_player_args:
      model_name: 'llama'
      game_intro_file: "src/prompts/dond/rules.txt"
      chain_of_thought_file: "src/prompts/dond/cot.txt" # false if none, else link to txt file 
      finalization_file: "src/prompts/dond/finalization.txt"
      new_round_file: "src/prompts/dond/new_round.txt"
      max_retries: 5

  player_b:
    id: 1
    dond_player_args:
      model_name: 'llama'
      game_intro_file: "src/prompts/dond/rules.txt"
      chain_of_thought_file: "src/prompts/dond/cot.txt" # false if none, else link to txt file 
      finalization_file: "src/prompts/dond/finalization.txt"
      new_round_file: "src/prompts/dond//new_round.txt"
      max_retries: 5



    





